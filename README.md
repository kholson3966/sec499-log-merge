In the SANS SEC499 class the pupil manages a Dshield collector honeypot. The honeypot is preconfigured to capture some logging. Included are firewall logs stored in an active log as /var/log/dshield.log. Once the active log reaches 100,000 lines or has aged 86,400 seconds, which ever comes first, an archive of that log is written in gzip format and a new active log file begins. The sensor is configured to keep four dshield.log gzip archives before the oldest archive file is discarded.
A goal of managing the Dshield collector is to report on anything interesting. To do that we need data. I want to accumulate the honeypot firewall logs and not lose them. This script endeavors to make that happen. The script opens the gzipped files, extracts data it has not previously seen and adds that data to a file no larger than 50MB. These files are stored in /var/log/dshield_merged/ as successively numbered files in the original data format.
